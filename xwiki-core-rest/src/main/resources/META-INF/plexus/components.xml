<?xml version="1.0" encoding="UTF-8"?>
<component-set>
	<components>

		<!-- *************************** -->
		<!-- * Resource class registry * -->
		<!-- *************************** -->
		<component>
			<role>org.xwiki.rest.XWikiResourceClassRegistry
			</role>
			<role-hint>default</role-hint>
			<implementation>org.xwiki.rest.XWikiResourceClassRegistry
			</implementation>
			<instantiation-strategy>singleton</instantiation-strategy>
		</component>

		<!-- *********************** -->
		<!-- * Restlet application * -->
		<!-- *********************** -->
		<component>
			<role>org.xwiki.rest.XWikiRestApplication
			</role>
			<implementation>org.xwiki.rest.XWikiRestApplication
			</implementation>
			<role-hint>default</role-hint>
			<instantiation-strategy>singleton</instantiation-strategy>
			<requirements>
				<requirement>
					<role>org.xwiki.rest.XWikiResource
					</role>
					<field-name>classNameToResourceMap
					</field-name>
				</requirement>
			</requirements>
		</component>
		
		<!-- ***************** -->
		<!-- * Root resource * -->
		<!-- ***************** -->
		<component>
			<role>org.xwiki.rest.XWikiResource
			</role>
			<role-hint>org.xwiki.rest.resources.RootResource
			</role-hint>
			<instantiation-strategy>per-lookup</instantiation-strategy>
			<implementation>org.xwiki.rest.resources.RootResource
			</implementation>
			<requirements>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceClassRegistry
					</role>
				</requirement>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceRepresenter
					</role>
					<role-hint>org.xwiki.rest.resources.RootResource
					</role-hint>
					<field-name>descriptorToRepresenterMap
					</field-name>
				</requirement>
			</requirements>
			<configuration>
				<uriPattern>/</uriPattern>
			</configuration>
		</component>

		<!-- *** Representers for Root resource *** -->

		<component>
			<role>org.xwiki.rest.XWikiResourceRepresenter
			</role>
			<role-hint>org.xwiki.rest.resources.RootResource:text/xml
			</role-hint>
			<instantiation-strategy>singleton</instantiation-strategy>
			<implementation>
				org.xwiki.rest.representers.XmlTextXStreamRepresenter
			</implementation>
		</component>
		
		<!-- ***************** -->
		<!-- * Wikis resource * -->
		<!-- ***************** -->
		<component>
			<role>org.xwiki.rest.XWikiResource
			</role>
			<role-hint>org.xwiki.rest.resources.WikisResource
			</role-hint>
			<instantiation-strategy>per-lookup</instantiation-strategy>
			<implementation>org.xwiki.rest.resources.WikisResource
			</implementation>
			<requirements>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceClassRegistry
					</role>
				</requirement>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceRepresenter
					</role>
					<role-hint>org.xwiki.rest.resources.WikisResource
					</role-hint>
					<field-name>descriptorToRepresenterMap
					</field-name>
				</requirement>
			</requirements>
			<configuration>
				<uriPattern>/wikis</uriPattern>
			</configuration>
		</component>

		<!-- *** Representers for Wikis resource *** -->

		<component>
			<role>org.xwiki.rest.XWikiResourceRepresenter
			</role>
			<role-hint>org.xwiki.rest.resources.WikisResource:text/xml
			</role-hint>
			<instantiation-strategy>singleton</instantiation-strategy>
			<implementation>
				org.xwiki.rest.representers.XmlTextXStreamRepresenter
			</implementation>
		</component>

		<!-- ******************* -->
		<!-- * Spaces resource * -->
		<!-- ******************* -->
		<component>
			<role>org.xwiki.rest.XWikiResource
			</role>
			<!--
				Role hint must be the same as the implementation since it is used to
				lookup for the implementation in XWikiRouter.XWikiFinder.
			-->
			<role-hint>org.xwiki.rest.resources.SpacesResource
			</role-hint>
			<!--  Resource instantiation strategy should be per-lookup -->
			<instantiation-strategy>per-lookup</instantiation-strategy>
			<implementation>org.xwiki.rest.resources.SpacesResource
			</implementation>
			<requirements>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceClassRegistry
					</role>
				</requirement>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceRepresenter
					</role>
					<role-hint>org.xwiki.rest.resources.SpacesResource
					</role-hint>
					<field-name>descriptorToRepresenterMap
					</field-name>
				</requirement>
			</requirements>
			<configuration>
				<uriPattern>/wikis/{wikiName}/spaces</uriPattern>
			</configuration>
		</component>

		<!-- *** Representers for Spaces resource *** -->

		<component>
			<role>org.xwiki.rest.XWikiResourceRepresenter
			</role>
			<!--
				Here, for representers, it doesn't really matter what you put after
				the class name in the role hint. As a convention I used
				:mediaTypeName. The important thing is that the class name is well
				spelled because it is checked against the actual resource class name
				in order to understand which representer belongs to which resource.
				This is needed because we must differentiate the role hints in order
				to associate more representer to a single resource. It is clear that
				the (initial part of) the role hint is used to bind a representer to
				a given resource by using the resource class name.
			-->
			<role-hint>
				org.xwiki.rest.resources.SpacesResource:text/xml
			</role-hint>
			<instantiation-strategy>singleton</instantiation-strategy>
			<implementation>
				org.xwiki.rest.representers.XmlTextXStreamRepresenter
			</implementation>
		</component>		
		
		<!-- ******************* -->
		<!-- * Space resource * -->
		<!-- ******************* -->
		<component>
			<role>org.xwiki.rest.XWikiResource
			</role>			
			<role-hint>org.xwiki.rest.resources.SpaceResource
			</role-hint>			
			<instantiation-strategy>per-lookup</instantiation-strategy>
			<implementation>org.xwiki.rest.resources.SpaceResource
			</implementation>
			<requirements>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceClassRegistry
					</role>
				</requirement>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceRepresenter
					</role>
					<role-hint>org.xwiki.rest.resources.SpaceResource
					</role-hint>
					<field-name>descriptorToRepresenterMap
					</field-name>
				</requirement>
			</requirements>
			<configuration>
				<uriPattern>/wikis/{wikiName}/spaces/{spaceName}</uriPattern>
			</configuration>
		</component>

		<!-- *** Representers for Spaces resource *** -->

		<component>
			<role>org.xwiki.rest.XWikiResourceRepresenter
			</role>			
			<role-hint>
				org.xwiki.rest.resources.SpaceResource:text/xml
			</role-hint>
			<instantiation-strategy>singleton</instantiation-strategy>
			<implementation>
				org.xwiki.rest.representers.XmlTextXStreamRepresenter
			</implementation>
		</component>		

		<!-- ****************** -->
		<!-- * Pages resource * -->
		<!-- ****************** -->
		<component>
			<role>org.xwiki.rest.XWikiResource
			</role>
			<role-hint>org.xwiki.rest.resources.PagesResource
			</role-hint>
			<instantiation-strategy>per-lookup</instantiation-strategy>
			<implementation>org.xwiki.rest.resources.PagesResource
			</implementation>
			<requirements>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceClassRegistry
					</role>
				</requirement>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceRepresenter
					</role>
					<role-hint>org.xwiki.rest.resources.PagesResource
					</role-hint>
					<field-name>descriptorToRepresenterMap
					</field-name>
				</requirement>
			</requirements>
			<configuration>
				<uriPattern>/wikis/{wikiName}/spaces/{spaceName}/pages
				</uriPattern>
			</configuration>
		</component>

		<!-- *** Representers for Pages resource *** -->

		<component>
			<role>org.xwiki.rest.XWikiResourceRepresenter
			</role>
			<role-hint>
				org.xwiki.rest.resources.PagesResource:text/xml
			</role-hint>
			<instantiation-strategy>singleton</instantiation-strategy>
			<implementation>
				org.xwiki.rest.representers.XmlTextXStreamRepresenter
			</implementation>
		</component>
		
		<!-- ***************** -->
		<!-- * Page resource * -->
		<!-- ***************** -->
		<component>
			<role>org.xwiki.rest.XWikiResource
			</role>
			<role-hint>org.xwiki.rest.resources.PageResource
			</role-hint>
			<instantiation-strategy>per-lookup</instantiation-strategy>
			<implementation>org.xwiki.rest.resources.PageResource
			</implementation>
			<requirements>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceClassRegistry
					</role>
				</requirement>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceRepresenter
					</role>
					<role-hint>org.xwiki.rest.resources.PageResource
					</role-hint>
					<field-name>descriptorToRepresenterMap
					</field-name>
				</requirement>
			</requirements>
			<configuration>
				<uriPattern>/wikis/{wikiName}/spaces/{spaceName}/pages/{pageName}
				</uriPattern>
			</configuration>
		</component>
		
		<!-- *** Representers for PageVersionresource *** -->

		<component>
			<role>org.xwiki.rest.XWikiResourceRepresenter
			</role>
			<role-hint>
				org.xwiki.rest.resources.PageResource:text/xml
			</role-hint>
			<instantiation-strategy>singleton</instantiation-strategy>
			<implementation>
				org.xwiki.rest.representers.XmlTextXStreamRepresenter
			</implementation>
		</component>
		
		<!-- ************************* -->
		<!-- * Page version resource * -->
		<!-- ************************* -->
		<component>
			<role>org.xwiki.rest.XWikiResource
			</role>
			<role-hint>org.xwiki.rest.resources.PageVersionResource
			</role-hint>
			<instantiation-strategy>per-lookup</instantiation-strategy>
			<implementation>org.xwiki.rest.resources.PageVersionResource
			</implementation>
			<requirements>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceClassRegistry
					</role>
				</requirement>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceRepresenter
					</role>
					<role-hint>org.xwiki.rest.resources.PageVersionResource
					</role-hint>
					<field-name>descriptorToRepresenterMap
					</field-name>
				</requirement>
			</requirements>
			<configuration>
				<uriPattern>/wikis/{wikiName}/spaces/{spaceName}/pages/{pageName}/history/{version}
				</uriPattern>
			</configuration>
		</component>

		<!-- *** Representers for PageVersionresource *** -->

		<component>
			<role>org.xwiki.rest.XWikiResourceRepresenter
			</role>
			<role-hint>
				org.xwiki.rest.resources.PageVersionResource:text/xml
			</role-hint>
			<instantiation-strategy>singleton</instantiation-strategy>
			<implementation>
				org.xwiki.rest.representers.XmlTextXStreamRepresenter
			</implementation>
		</component>
		
		<!-- ************************* -->
		<!-- * Translations resource * -->
		<!-- ************************* -->
		<component>
			<role>org.xwiki.rest.XWikiResource
			</role>
			<role-hint>org.xwiki.rest.resources.TranslationsResource
			</role-hint>
			<instantiation-strategy>per-lookup</instantiation-strategy>
			<implementation>org.xwiki.rest.resources.TranslationsResource
			</implementation>
			<requirements>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceClassRegistry
					</role>
				</requirement>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceRepresenter
					</role>
					<role-hint>org.xwiki.rest.resources.TranslationsResource
					</role-hint>
					<field-name>descriptorToRepresenterMap
					</field-name>
				</requirement>
			</requirements>
			<configuration>
				<uriPattern>/wikis/{wikiName}/spaces/{spaceName}/pages/{pageName}/translations
				</uriPattern>
			</configuration>
		</component>

		<!-- *** Representers for Page resource *** -->

		<component>
			<role>org.xwiki.rest.XWikiResourceRepresenter
			</role>
			<role-hint>
				org.xwiki.rest.resources.TranslationsResource:text/xml
			</role-hint>
			<instantiation-strategy>singleton</instantiation-strategy>
			<implementation>
				org.xwiki.rest.representers.XmlTextXStreamRepresenter
			</implementation>
		</component>
		
		<!-- ***************************** -->
		<!-- * Page translation resource * -->
		<!-- ***************************** -->
		<component>
			<role>org.xwiki.rest.XWikiResource
			</role>
			<role-hint>org.xwiki.rest.resources.PageTranslationResource
			</role-hint>
			<instantiation-strategy>per-lookup</instantiation-strategy>
			<implementation>org.xwiki.rest.resources.PageTranslationResource
			</implementation>
			<requirements>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceClassRegistry
					</role>
				</requirement>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceRepresenter
					</role>
					<role-hint>org.xwiki.rest.resources.PageTranslationResource
					</role-hint>
					<field-name>descriptorToRepresenterMap
					</field-name>
				</requirement>
			</requirements>
			<configuration>
				<uriPattern>/wikis/{wikiName}/spaces/{spaceName}/pages/{pageName}/translations/{languageId}
				</uriPattern>
			</configuration>
		</component>

		<!-- *** Representers for Page resource *** -->

		<component>
			<role>org.xwiki.rest.XWikiResourceRepresenter
			</role>
			<role-hint>
				org.xwiki.rest.resources.PageTranslationResource:text/xml
			</role-hint>
			<instantiation-strategy>singleton</instantiation-strategy>
			<implementation>
				org.xwiki.rest.representers.XmlTextXStreamRepresenter
			</implementation>
		</component>
		
		<!-- ***************************** -->
		<!-- * Page translation version resource * -->
		<!-- ***************************** -->
		<component>
			<role>org.xwiki.rest.XWikiResource
			</role>
			<role-hint>org.xwiki.rest.resources.PageTranslationVersionResource
			</role-hint>
			<instantiation-strategy>per-lookup</instantiation-strategy>
			<implementation>org.xwiki.rest.resources.PageTranslationVersionResource
			</implementation>
			<requirements>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceClassRegistry
					</role>
				</requirement>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceRepresenter
					</role>
					<role-hint>org.xwiki.rest.resources.PageTranslationVersionResource
					</role-hint>
					<field-name>descriptorToRepresenterMap
					</field-name>
				</requirement>
			</requirements>
			<configuration>
				<uriPattern>/wikis/{wikiName}/spaces/{spaceName}/pages/{pageName}/translations/{languageId}/history/{version}
				</uriPattern>
			</configuration>
		</component>

		<!-- *** Representers for Page resource *** -->

		<component>
			<role>org.xwiki.rest.XWikiResourceRepresenter
			</role>
			<role-hint>
				org.xwiki.rest.resources.PageTranslationVersionResource:text/xml
			</role-hint>
			<instantiation-strategy>singleton</instantiation-strategy>
			<implementation>
				org.xwiki.rest.representers.XmlTextXStreamRepresenter
			</implementation>
		</component>
		
		<!-- ************************* -->
		<!-- * Page history resource * -->
		<!-- ************************* -->
		<component>
			<role>org.xwiki.rest.XWikiResource
			</role>
			<role-hint>org.xwiki.rest.resources.PageHistoryResource
			</role-hint>
			<instantiation-strategy>per-lookup</instantiation-strategy>
			<implementation>org.xwiki.rest.resources.PageHistoryResource
			</implementation>
			<requirements>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceClassRegistry
					</role>
				</requirement>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceRepresenter
					</role>
					<role-hint>org.xwiki.rest.resources.PageHistoryResource
					</role-hint>
					<field-name>descriptorToRepresenterMap
					</field-name>
				</requirement>
			</requirements>
			<configuration>
				<uriPattern>/wikis/{wikiName}/spaces/{spaceName}/pages/{pageName}/history
				</uriPattern>
			</configuration>
		</component>

		<!-- *** Representers for PageHistory resource *** -->

		<component>
			<role>org.xwiki.rest.XWikiResourceRepresenter
			</role>
			<role-hint>
				org.xwiki.rest.resources.PageHistoryResource:text/xml
			</role-hint>
			<instantiation-strategy>singleton</instantiation-strategy>
			<implementation>
				org.xwiki.rest.representers.XmlTextXStreamRepresenter
			</implementation>
		</component>
		
		<!-- ************************************* -->
		<!-- * Page translation history resource * -->
		<!-- ************************************* -->
		<component>
			<role>org.xwiki.rest.XWikiResource
			</role>
			<role-hint>org.xwiki.rest.resources.PageTranslationHistoryResource
			</role-hint>
			<instantiation-strategy>per-lookup</instantiation-strategy>
			<implementation>org.xwiki.rest.resources.PageTranslationHistoryResource
			</implementation>
			<requirements>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceClassRegistry
					</role>
				</requirement>
				<requirement>
					<role>org.xwiki.rest.XWikiResourceRepresenter
					</role>
					<role-hint>org.xwiki.rest.resources.PageTranslationHistoryResource
					</role-hint>
					<field-name>descriptorToRepresenterMap
					</field-name>
				</requirement>
			</requirements>
			<configuration>
				<uriPattern>/wikis/{wikiName}/spaces/{spaceName}/pages/{pageName}/translations/{languageId}/history
				</uriPattern>
			</configuration>
		</component>

		<!-- *** Representers for PageTranslationHistory resource *** -->

		<component>
			<role>org.xwiki.rest.XWikiResourceRepresenter
			</role>
			<role-hint>
				org.xwiki.rest.resources.PageTranslationHistoryResource:text/xml
			</role-hint>
			<instantiation-strategy>singleton</instantiation-strategy>
			<implementation>
				org.xwiki.rest.representers.XmlTextXStreamRepresenter
			</implementation>
		</component>

	</components>
</component-set>

